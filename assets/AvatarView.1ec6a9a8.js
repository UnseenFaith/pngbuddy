import{u as ue,V as H}from"./VImg.22f8f198.js";import{A as D,aA as le,c as fe,w as de,V as he,o as pe,ay as R,a as q,aB as S,B as P}from"./index.95fa3473.js";var B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ve(r){var a=r.default;if(typeof a=="function"){var e=function(){return a.apply(this,arguments)};e.prototype=a.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(o){var v=Object.getOwnPropertyDescriptor(r,o);Object.defineProperty(e,o,v.get?v:{enumerable:!0,get:function(){return r[o]}})}),e}var W={exports:{}},E,G;function ge(){if(G)return E;G=1;var r=1e3,a=r*60,e=a*60,o=e*24,v=o*7,p=o*365.25;E=function(t,n){n=n||{};var l=typeof t;if(l==="string"&&t.length>0)return _(t);if(l==="number"&&isFinite(t))return n.long?f(t):g(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function _(t){if(t=String(t),!(t.length>100)){var n=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!n){var l=parseFloat(n[1]),d=(n[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return l*p;case"weeks":case"week":case"w":return l*v;case"days":case"day":case"d":return l*o;case"hours":case"hour":case"hrs":case"hr":case"h":return l*e;case"minutes":case"minute":case"mins":case"min":case"m":return l*a;case"seconds":case"second":case"secs":case"sec":case"s":return l*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}function g(t){var n=Math.abs(t);return n>=o?Math.round(t/o)+"d":n>=e?Math.round(t/e)+"h":n>=a?Math.round(t/a)+"m":n>=r?Math.round(t/r)+"s":t+"ms"}function f(t){var n=Math.abs(t);return n>=o?i(t,n,o,"day"):n>=e?i(t,n,e,"hour"):n>=a?i(t,n,a,"minute"):n>=r?i(t,n,r,"second"):t+" ms"}function i(t,n,l,d){var y=n>=l*1.5;return Math.round(t/l)+" "+d+(y?"s":"")}return E}function ye(r){e.debug=e,e.default=e,e.coerce=f,e.disable=p,e.enable=v,e.enabled=_,e.humanize=ge(),e.destroy=i,Object.keys(r).forEach(t=>{e[t]=r[t]}),e.names=[],e.skips=[],e.formatters={};function a(t){let n=0;for(let l=0;l<t.length;l++)n=(n<<5)-n+t.charCodeAt(l),n|=0;return e.colors[Math.abs(n)%e.colors.length]}e.selectColor=a;function e(t){let n,l=null,d,y;function h(...u){if(!h.enabled)return;const w=h,s=Number(new Date),c=s-(n||s);w.diff=c,w.prev=n,w.curr=s,n=s,u[0]=e.coerce(u[0]),typeof u[0]!="string"&&u.unshift("%O");let m=0;u[0]=u[0].replace(/%([a-zA-Z%])/g,(F,b)=>{if(F==="%%")return"%";m++;const x=e.formatters[b];if(typeof x=="function"){const k=u[m];F=x.call(w,k),u.splice(m,1),m--}return F}),e.formatArgs.call(w,u),(w.log||e.log).apply(w,u)}return h.namespace=t,h.useColors=e.useColors(),h.color=e.selectColor(t),h.extend=o,h.destroy=e.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==e.namespaces&&(d=e.namespaces,y=e.enabled(t)),y),set:u=>{l=u}}),typeof e.init=="function"&&e.init(h),h}function o(t,n){const l=e(this.namespace+(typeof n>"u"?":":n)+t);return l.log=this.log,l}function v(t){e.save(t),e.namespaces=t,e.names=[],e.skips=[];let n;const l=(typeof t=="string"?t:"").split(/[\s,]+/),d=l.length;for(n=0;n<d;n++)!l[n]||(t=l[n].replace(/\*/g,".*?"),t[0]==="-"?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function p(){const t=[...e.names.map(g),...e.skips.map(g).map(n=>"-"+n)].join(",");return e.enable(""),t}function _(t){if(t[t.length-1]==="*")return!0;let n,l;for(n=0,l=e.skips.length;n<l;n++)if(e.skips[n].test(t))return!1;for(n=0,l=e.names.length;n<l;n++)if(e.names[n].test(t))return!0;return!1}function g(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}function f(t){return t instanceof Error?t.stack||t.message:t}function i(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}var me=ye;(function(r,a){a.formatArgs=o,a.save=v,a.load=p,a.useColors=e,a.storage=_(),a.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),a.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function e(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;f.splice(1,0,i,"color: inherit");let t=0,n=0;f[0].replace(/%[a-zA-Z%]/g,l=>{l!=="%%"&&(t++,l==="%c"&&(n=t))}),f.splice(n,0,i)}a.log=console.debug||console.log||(()=>{});function v(f){try{f?a.storage.setItem("debug",f):a.storage.removeItem("debug")}catch{}}function p(){let f;try{f=a.storage.getItem("debug")}catch{}return!f&&typeof process<"u"&&"env"in process&&(f={}.DEBUG),f}function _(){try{return localStorage}catch{}}r.exports=me(a);const{formatters:g}=r.exports;g.j=function(f){try{return JSON.stringify(f)}catch(i){return"[UnexpectedJSONParseError]: "+i.message}}})(W,W.exports);const Ce=W.exports;var ee={exports:{}};(function(r){var a=Object.prototype.hasOwnProperty,e="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(e=!1));function v(f,i,t){this.fn=f,this.context=i,this.once=t||!1}function p(f,i,t,n,l){if(typeof t!="function")throw new TypeError("The listener must be a function");var d=new v(t,n||f,l),y=e?e+i:i;return f._events[y]?f._events[y].fn?f._events[y]=[f._events[y],d]:f._events[y].push(d):(f._events[y]=d,f._eventsCount++),f}function _(f,i){--f._eventsCount===0?f._events=new o:delete f._events[i]}function g(){this._events=new o,this._eventsCount=0}g.prototype.eventNames=function(){var i=[],t,n;if(this._eventsCount===0)return i;for(n in t=this._events)a.call(t,n)&&i.push(e?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},g.prototype.listeners=function(i){var t=e?e+i:i,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var l=0,d=n.length,y=new Array(d);l<d;l++)y[l]=n[l].fn;return y},g.prototype.listenerCount=function(i){var t=e?e+i:i,n=this._events[t];return n?n.fn?1:n.length:0},g.prototype.emit=function(i,t,n,l,d,y){var h=e?e+i:i;if(!this._events[h])return!1;var u=this._events[h],w=arguments.length,s,c;if(u.fn){switch(u.once&&this.removeListener(i,u.fn,void 0,!0),w){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,l),!0;case 5:return u.fn.call(u.context,t,n,l,d),!0;case 6:return u.fn.call(u.context,t,n,l,d,y),!0}for(c=1,s=new Array(w-1);c<w;c++)s[c-1]=arguments[c];u.fn.apply(u.context,s)}else{var m=u.length,C;for(c=0;c<m;c++)switch(u[c].once&&this.removeListener(i,u[c].fn,void 0,!0),w){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,l);break;default:if(!s)for(C=1,s=new Array(w-1);C<w;C++)s[C-1]=arguments[C];u[c].fn.apply(u[c].context,s)}}return!0},g.prototype.on=function(i,t,n){return p(this,i,t,n,!1)},g.prototype.once=function(i,t,n){return p(this,i,t,n,!0)},g.prototype.removeListener=function(i,t,n,l){var d=e?e+i:i;if(!this._events[d])return this;if(!t)return _(this,d),this;var y=this._events[d];if(y.fn)y.fn===t&&(!l||y.once)&&(!n||y.context===n)&&_(this,d);else{for(var h=0,u=[],w=y.length;h<w;h++)(y[h].fn!==t||l&&!y[h].once||n&&y[h].context!==n)&&u.push(y[h]);u.length?this._events[d]=u.length===1?u[0]:u:_(this,d)}return this},g.prototype.removeAllListeners=function(i){var t;return i?(t=e?e+i:i,this._events[t]&&_(this,t)):(this._events=new o,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=e,g.EventEmitter=g,r.exports=g})(ee);const J=ee.exports;var L=null;typeof WebSocket<"u"?L=WebSocket:typeof MozWebSocket<"u"?L=MozWebSocket:typeof B<"u"?L=B.WebSocket||B.MozWebSocket:typeof window<"u"?L=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(L=self.WebSocket||self.MozWebSocket);var K=L,te={exports:{}};function we(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var T={exports:{}};const _e={},Fe=Object.freeze(Object.defineProperty({__proto__:null,default:_e},Symbol.toStringTag,{value:"Module"})),be=ve(Fe);var Z;function ne(){return Z||(Z=1,function(r,a){(function(e,o){r.exports=o()})(B,function(){var e=e||function(o,v){var p;if(typeof window<"u"&&window.crypto&&(p=window.crypto),typeof self<"u"&&self.crypto&&(p=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(p=globalThis.crypto),!p&&typeof window<"u"&&window.msCrypto&&(p=window.msCrypto),!p&&typeof B<"u"&&B.crypto&&(p=B.crypto),!p&&typeof we=="function")try{p=be}catch{}var _=function(){if(p){if(typeof p.getRandomValues=="function")try{return p.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof p.randomBytes=="function")try{return p.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},g=Object.create||function(){function s(){}return function(c){var m;return s.prototype=c,m=new s,s.prototype=null,m}}(),f={},i=f.lib={},t=i.Base=function(){return{extend:function(s){var c=g(this);return s&&c.mixIn(s),(!c.hasOwnProperty("init")||this.init===c.init)&&(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var s=this.extend();return s.init.apply(s,arguments),s},init:function(){},mixIn:function(s){for(var c in s)s.hasOwnProperty(c)&&(this[c]=s[c]);s.hasOwnProperty("toString")&&(this.toString=s.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),n=i.WordArray=t.extend({init:function(s,c){s=this.words=s||[],c!=v?this.sigBytes=c:this.sigBytes=s.length*4},toString:function(s){return(s||d).stringify(this)},concat:function(s){var c=this.words,m=s.words,C=this.sigBytes,F=s.sigBytes;if(this.clamp(),C%4)for(var b=0;b<F;b++){var x=m[b>>>2]>>>24-b%4*8&255;c[C+b>>>2]|=x<<24-(C+b)%4*8}else for(var k=0;k<F;k+=4)c[C+k>>>2]=m[k>>>2];return this.sigBytes+=F,this},clamp:function(){var s=this.words,c=this.sigBytes;s[c>>>2]&=4294967295<<32-c%4*8,s.length=o.ceil(c/4)},clone:function(){var s=t.clone.call(this);return s.words=this.words.slice(0),s},random:function(s){for(var c=[],m=0;m<s;m+=4)c.push(_());return new n.init(c,s)}}),l=f.enc={},d=l.Hex={stringify:function(s){for(var c=s.words,m=s.sigBytes,C=[],F=0;F<m;F++){var b=c[F>>>2]>>>24-F%4*8&255;C.push((b>>>4).toString(16)),C.push((b&15).toString(16))}return C.join("")},parse:function(s){for(var c=s.length,m=[],C=0;C<c;C+=2)m[C>>>3]|=parseInt(s.substr(C,2),16)<<24-C%8*4;return new n.init(m,c/2)}},y=l.Latin1={stringify:function(s){for(var c=s.words,m=s.sigBytes,C=[],F=0;F<m;F++){var b=c[F>>>2]>>>24-F%4*8&255;C.push(String.fromCharCode(b))}return C.join("")},parse:function(s){for(var c=s.length,m=[],C=0;C<c;C++)m[C>>>2]|=(s.charCodeAt(C)&255)<<24-C%4*8;return new n.init(m,c)}},h=l.Utf8={stringify:function(s){try{return decodeURIComponent(escape(y.stringify(s)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(s){return y.parse(unescape(encodeURIComponent(s)))}},u=i.BufferedBlockAlgorithm=t.extend({reset:function(){this._data=new n.init,this._nDataBytes=0},_append:function(s){typeof s=="string"&&(s=h.parse(s)),this._data.concat(s),this._nDataBytes+=s.sigBytes},_process:function(s){var c,m=this._data,C=m.words,F=m.sigBytes,b=this.blockSize,x=b*4,k=F/x;s?k=o.ceil(k):k=o.max((k|0)-this._minBufferSize,0);var M=k*b,A=o.min(M*4,F);if(M){for(var N=0;N<M;N+=b)this._doProcessBlock(C,N);c=C.splice(0,M),m.sigBytes-=A}return new n.init(c,A)},clone:function(){var s=t.clone.call(this);return s._data=this._data.clone(),s},_minBufferSize:0});i.Hasher=u.extend({cfg:t.extend(),init:function(s){this.cfg=this.cfg.extend(s),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(s){return this._append(s),this._process(),this},finalize:function(s){s&&this._append(s);var c=this._doFinalize();return c},blockSize:16,_createHelper:function(s){return function(c,m){return new s.init(m).finalize(c)}},_createHmacHelper:function(s){return function(c,m){return new w.HMAC.init(s,m).finalize(c)}}});var w=f.algo={};return f}(Math);return e})}(T)),T.exports}(function(r,a){(function(e,o){r.exports=o(ne())})(B,function(e){return function(o){var v=e,p=v.lib,_=p.WordArray,g=p.Hasher,f=v.algo,i=[],t=[];(function(){function d(w){for(var s=o.sqrt(w),c=2;c<=s;c++)if(!(w%c))return!1;return!0}function y(w){return(w-(w|0))*4294967296|0}for(var h=2,u=0;u<64;)d(h)&&(u<8&&(i[u]=y(o.pow(h,1/2))),t[u]=y(o.pow(h,1/3)),u++),h++})();var n=[],l=f.SHA256=g.extend({_doReset:function(){this._hash=new _.init(i.slice(0))},_doProcessBlock:function(d,y){for(var h=this._hash.words,u=h[0],w=h[1],s=h[2],c=h[3],m=h[4],C=h[5],F=h[6],b=h[7],x=0;x<64;x++){if(x<16)n[x]=d[y+x]|0;else{var k=n[x-15],M=(k<<25|k>>>7)^(k<<14|k>>>18)^k>>>3,A=n[x-2],N=(A<<15|A>>>17)^(A<<13|A>>>19)^A>>>10;n[x]=M+n[x-7]+N+n[x-16]}var se=m&C^~m&F,oe=u&w^u&s^w&s,ie=(u<<30|u>>>2)^(u<<19|u>>>13)^(u<<10|u>>>22),ae=(m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25),U=b+ae+se+t[x]+n[x],ce=ie+oe;b=F,F=C,C=m,m=c+U|0,c=s,s=w,w=u,u=U+ce|0}h[0]=h[0]+u|0,h[1]=h[1]+w|0,h[2]=h[2]+s|0,h[3]=h[3]+c|0,h[4]=h[4]+m|0,h[5]=h[5]+C|0,h[6]=h[6]+F|0,h[7]=h[7]+b|0},_doFinalize:function(){var d=this._data,y=d.words,h=this._nDataBytes*8,u=d.sigBytes*8;return y[u>>>5]|=128<<24-u%32,y[(u+64>>>9<<4)+14]=o.floor(h/4294967296),y[(u+64>>>9<<4)+15]=h,d.sigBytes=y.length*4,this._process(),this._hash},clone:function(){var d=g.clone.call(this);return d._hash=this._hash.clone(),d}});v.SHA256=g._createHelper(l),v.HmacSHA256=g._createHmacHelper(l)}(Math),e.SHA256})})(te);const Q=te.exports;var re={exports:{}};(function(r,a){(function(e,o){r.exports=o(ne())})(B,function(e){return function(){var o=e,v=o.lib,p=v.WordArray,_=o.enc;_.Base64={stringify:function(f){var i=f.words,t=f.sigBytes,n=this._map;f.clamp();for(var l=[],d=0;d<t;d+=3)for(var y=i[d>>>2]>>>24-d%4*8&255,h=i[d+1>>>2]>>>24-(d+1)%4*8&255,u=i[d+2>>>2]>>>24-(d+2)%4*8&255,w=y<<16|h<<8|u,s=0;s<4&&d+s*.75<t;s++)l.push(n.charAt(w>>>6*(3-s)&63));var c=n.charAt(64);if(c)for(;l.length%4;)l.push(c);return l.join("")},parse:function(f){var i=f.length,t=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var l=0;l<t.length;l++)n[t.charCodeAt(l)]=l}var d=t.charAt(64);if(d){var y=f.indexOf(d);y!==-1&&(i=y)}return g(f,i,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function g(f,i,t){for(var n=[],l=0,d=0;d<i;d++)if(d%4){var y=t[f.charCodeAt(d-1)]<<d%4*2,h=t[f.charCodeAt(d)]>>>6-d%4*2,u=y|h;n[l>>>2]|=u<<24-l%4*8,l++}return p.create(n,l)}}(),e.enc.Base64})})(re);const X=re.exports;function j(){return j=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var e=arguments[a];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},j.apply(this,arguments)}function xe(r,a){if(r==null)return{};var e={},o=Object.keys(r),v,p;for(p=0;p<o.length;p++)v=o[p],!(a.indexOf(v)>=0)&&(e[v]=r[v]);return e}var I;(function(r){r[r.Hello=0]="Hello",r[r.Identify=1]="Identify",r[r.Identified=2]="Identified",r[r.Reidentify=3]="Reidentify",r[r.Event=5]="Event",r[r.Request=6]="Request",r[r.RequestResponse=7]="RequestResponse",r[r.RequestBatch=8]="RequestBatch",r[r.RequestBatchResponse=9]="RequestBatchResponse"})(I||(I={}));var V;(function(r){r[r.None=0]="None",r[r.General=1]="General",r[r.Config=2]="Config",r[r.Scenes=4]="Scenes",r[r.Inputs=8]="Inputs",r[r.Transitions=16]="Transitions",r[r.Filters=32]="Filters",r[r.Outputs=64]="Outputs",r[r.SceneItems=128]="SceneItems",r[r.MediaInputs=256]="MediaInputs",r[r.Vendors=512]="Vendors",r[r.Ui=1024]="Ui",r[r.All=1023]="All",r[r.InputVolumeMeters=65536]="InputVolumeMeters",r[r.InputActiveStateChanged=131072]="InputActiveStateChanged",r[r.InputShowStateChanged=262144]="InputShowStateChanged",r[r.SceneItemTransformChanged=524288]="SceneItemTransformChanged"})(V||(V={}));var Y;(function(r){r[r.None=-1]="None",r[r.SerialRealtime=0]="SerialRealtime",r[r.SerialFrame=1]="SerialFrame",r[r.Parallel=2]="Parallel"})(Y||(Y={}));function ke(r,a,e){const o=X.stringify(Q(e+r));return X.stringify(Q(o+a))}const Ie=["authentication","rpcVersion"],z=Ce("obs-websocket-js");class $ extends Error{constructor(a,e){super(e),this.code=void 0,this.code=a}}class O extends J{constructor(...a){super(...a),this._identified=!1,this.internalListeners=new J,this.socket=void 0}static generateMessageId(){return String(O.requestCounter++)}get identified(){return this._identified}async connect(a="ws://127.0.0.1:4455",e,o={}){var v=this;this.socket&&await this.disconnect();try{const p=this.internalEventPromise("ConnectionClosed"),_=this.internalEventPromise("ConnectionError");return await Promise.race([async function(){const g=await v.createConnection(a);return v.emit("Hello",g),v.identify(g,e,o)}(),new Promise((g,f)=>{_.then(i=>{i.message&&f(i)}),p.then(i=>{f(i)})})])}catch(p){throw await this.disconnect(),p}}async disconnect(){if(!this.socket||this.socket.readyState===K.CLOSED)return;const a=this.internalEventPromise("ConnectionClosed");this.socket.close(),await a}async reidentify(a){const e=this.internalEventPromise(`op:${I.Identified}`);return await this.message(I.Reidentify,a),e}async call(a,e){const o=O.generateMessageId(),v=this.internalEventPromise(`res:${o}`);await this.message(I.Request,{requestId:o,requestType:a,requestData:e});const{requestStatus:p,responseData:_}=await v;if(!p.result)throw new $(p.code,p.comment);return _}async callBatch(a,e={}){const o=O.generateMessageId(),v=this.internalEventPromise(`res:${o}`);await this.message(I.RequestBatch,j({requestId:o,requests:a},e));const{results:p}=await v;return p}cleanup(){!this.socket||(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket=void 0,this._identified=!1,this.internalListeners.removeAllListeners())}async createConnection(a){var e;const o=this.internalEventPromise("ConnectionOpened"),v=this.internalEventPromise(`op:${I.Hello}`);this.socket=new K(a,this.protocol),this.socket.onopen=this.onOpen.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),await o;const p=(e=this.socket)==null?void 0:e.protocol;if(!p)throw new $(-1,"Server sent no subprotocol");if(p!==this.protocol)throw new $(-1,"Server sent an invalid subprotocol");return v}async identify(a,e,o={}){let{authentication:v,rpcVersion:p}=a,_=xe(a,Ie);const g=j({rpcVersion:p},o);v&&e&&(g.authentication=ke(v.salt,v.challenge,e));const f=this.internalEventPromise(`op:${I.Identified}`);await this.message(I.Identify,g);const i=await f;return this._identified=!0,this.emit("Identified",i),j({rpcVersion:p},_,i)}async message(a,e){if(!this.socket)throw new Error("Not connected");if(!this.identified&&a!==1)throw new Error("Socket not identified");const o=await this.encodeMessage({op:a,d:e});this.socket.send(o)}async internalEventPromise(a){return new Promise(e=>{this.internalListeners.once(a,e)})}onOpen(a){z("socket.open"),this.emit("ConnectionOpened"),this.internalListeners.emit("ConnectionOpened",a)}async onMessage(a){try{const{op:e,d:o}=await this.decodeMessage(a.data);if(z("socket.message: %d %j",e,o),e===void 0||o===void 0)return;switch(e){case I.Event:{const{eventType:v,eventData:p}=o;this.emit(v,p);return}case I.RequestResponse:case I.RequestBatchResponse:{const{requestId:v}=o;this.internalListeners.emit(`res:${v}`,o);return}default:this.internalListeners.emit(`op:${e}`,o)}}catch(e){z("error handling message: %o",e)}}onError(a){z("socket.error: %o",a);const e=new $(-1,a.message);this.emit("ConnectionError",e),this.internalListeners.emit("ConnectionError",e)}onClose(a){z("socket.close: %s (%d)",a.reason,a.code);const e=new $(a.code,a.reason);this.emit("ConnectionClosed",e),this.internalListeners.emit("ConnectionClosed",e),this.cleanup()}}O.requestCounter=1;typeof exports<"u"&&Object.defineProperty(exports,"__esModule",{value:!0});class Be extends O{constructor(...a){super(...a),this.protocol="obswebsocket.json"}async encodeMessage(a){return JSON.stringify(a)}async decodeMessage(a){return JSON.parse(a)}}const Ae={class:"imgWrap"},Pe={class:"image"},Me={class:"image"},Re={class:"image"},Le={class:"image"},Oe={class:"image"},qe={__name:"AvatarView",async setup(r){let a,e;const o=ue(),v=D(!1),p=D(!1),_=D(!1),g=new Be;g.on("InputVolumeMeters",({inputs:i})=>{const t=i.filter(l=>l.inputName==o.inputDevice)[0];if(!t)return;20*Math.log10(t.inputLevelsMul[0][0])>o.threshold?v.value=!0:v.value=!1}),g.on("InputMuteStateChanged",i=>{i.inputName==o.inputDevice&&(_.value=i.inputMuted)}),g.on("InputCreated",i=>{!i.inputKind.startsWith("wasapi")||o.$patch({inputs:[...o.inputs,i.inputName]})}),g.on("InputNameChanged",i=>{o.inputDevice==i.oldInputName&&(o.inputDevice=i.inputName),o.$patch({inputs:[...o.inputs.filter(t=>t!=i.oldInputName),i.inputName]})});async function f(i,t){try{await g.connect("ws://127.0.0.1:"+t,i,{eventSubscriptions:V.Inputs|V.InputVolumeMeters});const{inputs:n}=await g.call("GetInputList"),l=n.filter(d=>d.inputKind.startsWith("wasapi"));o.inputs=l.map(d=>d.inputName)}catch(n){console.error(n)}}return setInterval(()=>{p.value||(p.value=!0,setTimeout(()=>{p.value=!1},o.blinkDuration))},o.blinkInterval),[a,e]=le(()=>f(o.password,o.port)),await a,e(),(i,t)=>(pe(),fe(he,{fluid:""},{default:de(()=>[R("div",Ae,[R("div",Pe,[q(H,{width:"1920",height:"1080",class:S(v.value?"inactive":"active"),src:P(o).idle},null,8,["class","src"])]),R("div",Me,[q(H,{width:"1920",height:"1080",class:S(v.value?"active":"inactive"),src:P(o).speak},null,8,["class","src"])]),R("div",Re,[q(H,{width:"1920",height:"1080",class:S(!v.value&&p.value&&P(o).blinkEnabled?"active":"inactive"),src:P(o).blink},null,8,["class","src"])]),R("div",Le,[q(H,{width:"1920",height:"1080",class:S(v.value&&p.value&&P(o).blinkSpeakEnabled?"active":"inactive"),src:P(o).blinkSpeak},null,8,["class","src"])]),R("div",Oe,[q(H,{width:"1920",height:"1080",class:S(P(o).grayscale&&_.value?"grayscale active":"inactive"),src:P(o).idle},null,8,["class","src"])])])]),_:1}))}};export{qe as default};
